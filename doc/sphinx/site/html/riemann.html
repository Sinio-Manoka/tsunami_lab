<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Riemann &mdash; Tsunami Project 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Finite Volume Discretization" href="Finite%20Volume%20Discretization.html" />
    <link rel="prev" title="1. Introduction" href="setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Tsunami Project
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">1. Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Riemann</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#important-links">2.1. Important Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="#riemann-solver">2.2. Riemann Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eigenvalues">2.2.1. Eigenvalues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flux-function">2.2.2. Flux function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eigencoefficients">2.2.3. Eigencoefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decomposition">2.2.4. decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#netupdates">2.2.5. netUpdates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id1">2.3. ParaView</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conclusion">2.3.1. Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#personal-contribution">2.4. Personal Contribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Finite%20Volume%20Discretization.html">3. Finite Volume Discretization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Tsunami Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">2. </span>Riemann</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/riemann.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="riemann">
<span id="ch-riemann-solver"></span><h1><span class="section-number">2. </span>Riemann<a class="headerlink" href="#riemann" title="Permalink to this headline"></a></h1>
<p>Welcome to the documentation for our the integration of a Riemann solver in a Finite Volume scheme.
in C++. This solver is designed to help
you only to slove for do 1D shallow water equations..
This documentation will guide you through the functions we implemented to compile the Riemann
solver. numerical solver which uses the Riemann solver produces CSV files as output, which can be visualized through <a class="reference external" href="https://www.paraview.org/download">ParaView</a> .</p>
<section id="important-links">
<h2><span class="section-number">2.1. </span>Important Links<a class="headerlink" href="#important-links" title="Permalink to this headline"></a></h2>
<p><a class="reference internal" href="setup.html#installation"><span class="std std-ref">Installation</span></a></p>
<p><a class="reference external" href="https://github.com/Sinio-Manoka/tsunami_lab">GitHub Page</a></p>
<p><a class="reference external" href="https://tsunami-99843.web.app/">Doxygen Documentation</a></p>
</section>
<section id="riemann-solver">
<h2><span class="section-number">2.2. </span>Riemann Solver<a class="headerlink" href="#riemann-solver" title="Permalink to this headline"></a></h2>
<section id="eigenvalues">
<h3><span class="section-number">2.2.1. </span>Eigenvalues<a class="headerlink" href="#eigenvalues" title="Permalink to this headline"></a></h3>
<p>To solve the problem, we must calculate the Eigenvalues. Before computing the eigenvalues,
we need to determine <span class="math notranslate nohighlight">\(u^{\text{Roe}}(q_l, q_r)\)</span> and  <span class="math notranslate nohighlight">\(h^{\text{Roe}}(q_l, q_r)\)</span>
using the following formula:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
      h^{\text{Roe}}(q_l, q_r) &amp;= \frac{1}{2} (h_l + h_r), \\
      u^{\text{Roe}}(q_l, q_r) &amp;=  \frac{u_l \sqrt{h_l} + u_r \sqrt{h_r}}{\sqrt{h_l}+\sqrt{h_r}}.
\end{aligned}\end{split}\]</div>
<p>To calculate the eigenvalue, we need to utilize the formula:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
      \lambda^{\text{Roe}}_{1}(q_l, q_r) &amp;= u^{\text{Roe}}(q_l, q_r) - \sqrt{gh^{\text{Roe}}(q_l, q_r)}, \\
      \lambda^{\text{Roe}}_{2}(q_l, q_r) &amp;= u^{\text{Roe}}(q_l, q_r) + \sqrt{gh^{\text{Roe}}(q_l, q_r)},
\end{aligned}\end{split}\]</div>
<p>The Equivalent C++ Code for that is :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::fwave::eigenwerte</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uL</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_uR</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_waveSpeedL</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">t_real</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">o_waveSpeedR</span><span class="w"> </span><span class="p">){</span><span class="w"></span>

<span class="n">t_real</span><span class="w"> </span><span class="n">l_hSqrtL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">i_hL</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="n">t_real</span><span class="w"> </span><span class="n">l_hSqrtR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">i_hR</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">//determine the height : h_Roe</span>
<span class="n">t_real</span><span class="w"> </span><span class="n">l_hRoe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">i_hL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i_hR</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="c1">//determine the particle velocity : u_Roe</span>
<span class="n">t_real</span><span class="w"> </span><span class="n">l_uRoe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_hSqrtL</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_uL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l_hSqrtR</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_uR</span><span class="p">;</span><span class="w"></span>
<span class="n">l_uRoe</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">l_hSqrtL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l_hSqrtR</span><span class="p">;</span><span class="w"></span>

<span class="c1">//compute the wave speeds</span>
<span class="n">t_real</span><span class="w"> </span><span class="n">l_ghSqrtRoe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_gSqrt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">l_hRoe</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">o_waveSpeedL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_uRoe</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l_ghSqrtRoe</span><span class="p">;</span><span class="w"></span>
<span class="n">o_waveSpeedR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l_uRoe</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l_ghSqrtRoe</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The function takes inputs <span class="math notranslate nohighlight">\(h_l\)</span> , <span class="math notranslate nohighlight">\(h_r\)</span> , <span class="math notranslate nohighlight">\(u_l\)</span> and <span class="math notranslate nohighlight">\(u_r\)</span> and produces the eigenvalue <span class="math notranslate nohighlight">\(\lambda^{\text{Roe}}_{1/2}\)</span> using the formula provided above.
<span class="math notranslate nohighlight">\(u_i\)</span> can be easily calculated using  <span class="math notranslate nohighlight">\(u_i = hu_i / h_i\)</span>.</p>
</div>
</section>
<section id="flux-function">
<h3><span class="section-number">2.2.2. </span>Flux function<a class="headerlink" href="#flux-function" title="Permalink to this headline"></a></h3>
<p>Now we need to calculate the difference in the flux function <span class="math notranslate nohighlight">\(\Delta f\)</span> which can be easily calculated
using this Formula: <span class="math notranslate nohighlight">\(\Delta f := f(q_r) - f(q_l)\)</span>. Before anything else, we must calculate <span class="math notranslate nohighlight">\(f(q_r) and f(q_l)\)</span>
using the following formula:  <span class="math notranslate nohighlight">\(f := [hu, hu^2 + \frac{1}{2}gh^2]^T\)</span> with respect to <span class="math notranslate nohighlight">\((q_r)\)</span> and <span class="math notranslate nohighlight">\((q_l)\)</span></p>
<p>The Equivalent C++ Code for that is:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::fwave::flux</span><span class="p">(</span><span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_hR</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_huL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_huR</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_fdelta</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="w"></span>
<span class="w"> </span><span class="cm">/*</span>
<span class="cm">  ___(1.3.3)___</span>
<span class="cm">  compute f(q_left):</span>
<span class="cm">  compute hu² = (hu)² / h</span>
<span class="cm"> */</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">pow2HuL</span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">i_huL</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">i_hL</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">gPowHL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">totalL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow2HuL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gPowHL</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">fql</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">i_huL</span><span class="p">,</span><span class="w"> </span><span class="n">totalL</span><span class="p">};</span><span class="w"></span>

<span class="w"> </span><span class="c1">//compute f(q_right)</span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">pow2HuR</span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">i_huR</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">i_hR</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">gPowHR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">i_hR</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">totalR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow2HuR</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gPowHR</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">fqr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">i_huR</span><span class="p">,</span><span class="w"> </span><span class="n">totalR</span><span class="p">};</span><span class="w"></span>

<span class="w"> </span><span class="c1">//compute Δf</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">o_fdelta</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">o_fdelta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">t_real</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="n">o_fdelta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fqr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fql</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="n">o_fdelta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fqr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fql</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We are provided with  <span class="math notranslate nohighlight">\(q_l = [h_l, (hu)_l]^T\)</span> and <span class="math notranslate nohighlight">\(q_r = [h_r, (hu)_r]^T\)</span> We simply insert these values into the equation
<span class="math notranslate nohighlight">\(f := [hu, hu^2 + \frac{1}{2}gh^2]^T\)</span> which results in the output <span class="math notranslate nohighlight">\(\Delta f\)</span>  as a 2D vector.</p>
</div>
</section>
<section id="eigencoefficients">
<h3><span class="section-number">2.2.3. </span>Eigencoefficients<a class="headerlink" href="#eigencoefficients" title="Permalink to this headline"></a></h3>
<p>The eigencoefficients <span class="math notranslate nohighlight">\(\alpha_p\)</span> are obtained by multiplying the <a class="reference external" href="https://mathworld.wolfram.com/MatrixInverse.html">inverse</a> of the matrix of right
eigenvectors <span class="math notranslate nohighlight">\(R=[r_1^\text{Roe}, r_2^\text{Roe}]\)</span> with the output vector from the
flux function</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
      \alpha_1 \\
      \alpha_2
    \end{bmatrix} =
    \begin{bmatrix}
      1 &amp; 1 \\
      \lambda^{\text{Roe}}_1 &amp; \lambda^{\text{Roe}}_2
    \end{bmatrix}^{-1} \Delta f.\end{split}\]</div>
<p>The Equivalent C++ Code for that is :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::fwave::eigencoefficientAlpha</span><span class="p">(</span><span class="n">t_real</span><span class="w"> </span><span class="n">i_inverse</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_delta_f</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"></span>
<span class="w">                                                     </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_eigencoefficients</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">o_eigencoefficients</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">o_eigencoefficients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">t_real</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">//m x n ° n x p =</span>
<span class="w"> </span><span class="n">o_eigencoefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i_inverse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_delta_f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i_inverse</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_delta_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w"> </span><span class="n">o_eigencoefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i_inverse</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_delta_f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i_inverse</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_delta_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>For the Calculation of the Inverse:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::fwave::inverseMatrix</span><span class="p">(</span><span class="n">t_real</span><span class="w"> </span><span class="n">i_eigen1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_eigen2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                             </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_inverse</span><span class="p">[</span><span class="mi">4</span><span class="p">]){</span><span class="w"></span>
<span class="w"> </span><span class="c1">//Compute the determinant of a 2x2 matrix</span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">det</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_eigen2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i_eigen1</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="c1">//Compute the inverses of specific 2x2 matrices. (first row contains only ones)</span>
<span class="w"> </span><span class="n">o_inverse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_eigen2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">det</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">o_inverse</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">det</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">o_inverse</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">i_eigen1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">det</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">o_inverse</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">det</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="decomposition">
<h3><span class="section-number">2.2.4. </span>decomposition<a class="headerlink" href="#decomposition" title="Permalink to this headline"></a></h3>
<p>After computing the eigencoefficient, <span class="math notranslate nohighlight">\(\alpha_p\)</span> ,
we can proceed to break down the difference in the flux function, <span class="math notranslate nohighlight">\(f\)</span>.
w between the values at qᵣ and qₗ, into the eigenvectors, which gives us the waves <span class="math notranslate nohighlight">\(Z_{1/2}\)</span></p>
<div class="math notranslate nohighlight">
\[\Delta f = \sum_{p=1}^2 \alpha_p r_p \equiv  \sum_{p=1}^2 Z_p, \qquad \alpha_p \in \mathbb{R}.\]</div>
<p>After computing the <span class="math notranslate nohighlight">\(Z_{1/2}\)</span>, we need to divide them into  <span class="math notranslate nohighlight">\(A^- \Delta Q\)</span> (the cell influenced by the left-going waves) and <span class="math notranslate nohighlight">\(A^+ \Delta Q\)</span> (the cell influenced by the right-going waves)
by using this formula:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
      A^- \Delta Q := \sum_{p:\{ \lambda_p^\text{Roe} &lt; 0 \}} Z_p \\
      A^+ \Delta Q := \sum_{p:\{ \lambda_p^\text{Roe} &gt; 0 \}} Z_p
\end{split}\end{split}\]</div>
<p>The Equivalent C++ Code for that is :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::fwave::decompose</span><span class="p">(</span><span class="n">t_real</span><span class="w"> </span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"></span>
<span class="w">                                         </span><span class="n">t_real</span><span class="w"> </span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"></span>
<span class="w">                                         </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"></span>
<span class="w">                                         </span><span class="n">t_real</span><span class="w"> </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="w"></span>


<span class="w"> </span><span class="c1">//Negative speed of wave propagation</span>
<span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="w"></span>
<span class="w">     </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">     </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="w"></span>
<span class="w">     </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w">   </span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">     </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">(</span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span><span class="w"></span>
<span class="w">     </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">//Positive speed of wave propagation</span>
<span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="w"></span>
<span class="w">     </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">     </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>

<span class="w"> </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">     </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i_alphas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i_eigens</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>the input of the function are the eigencoefficient <span class="math notranslate nohighlight">\(\alpha_p\)</span> and the Roe eigenvectors <span class="math notranslate nohighlight">\(r_{1/2}^{\text{Roe}}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
   r_1^{\text{Roe}} &amp;=
     \begin{bmatrix}
       1 \\ \lambda^{\text{Roe}}_1
     \end{bmatrix}, \\
   r_2^{\text{Roe}} &amp;=
     \begin{bmatrix}
       1 \\ \lambda^{\text{Roe}}_2
     \end{bmatrix}.
 \end{aligned}\end{split}\]</div>
<p>and the output of the function should be <span class="math notranslate nohighlight">\(A^- \Delta Q\)</span> (the cell influenced by the left-going waves) and <span class="math notranslate nohighlight">\(A^+ \Delta Q\)</span> (the cell influenced by the right-going waves) as a 2d vector.</p>
</div>
</section>
<section id="netupdates">
<h3><span class="section-number">2.2.5. </span>netUpdates<a class="headerlink" href="#netupdates" title="Permalink to this headline"></a></h3>
<p>This function should invoke every other function in the file to compute <span class="math notranslate nohighlight">\(A^- \Delta Q\)</span> and <span class="math notranslate nohighlight">\(A^+ \Delta Q\)</span>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">tsunami_lab::solvers::fwave::netUpdates</span><span class="p">(</span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_hR</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_huL</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">t_real</span><span class="w">   </span><span class="n">i_huR</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="n">t_real</span><span class="w">   </span><span class="n">o_minus_A_deltaQ</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"></span>
<span class="w">                                          </span><span class="n">t_real</span><span class="w">   </span><span class="n">o_plus_A_deltaQ</span><span class="p">[</span><span class="mi">2</span><span class="p">]){</span><span class="w"></span>
<span class="w">   </span><span class="c1">//calculate ul and ur</span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_uL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_huL</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i_hL</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_uR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i_huR</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i_hR</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_sL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_sR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">   </span><span class="c1">//calculate the eigenvalue</span>
<span class="w"> </span><span class="n">eigenwerte</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="n">i_hR</span><span class="p">,</span><span class="n">l_uL</span><span class="p">,</span><span class="n">l_uR</span><span class="p">,</span><span class="n">l_sL</span><span class="p">,</span><span class="n">l_sR</span><span class="p">);</span><span class="w"></span>

<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_inverse</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="w"></span>

<span class="w">   </span><span class="c1">//calculate the inverse matrix</span>
<span class="w"> </span><span class="n">inverseMatrix</span><span class="p">(</span><span class="n">l_sL</span><span class="p">,</span><span class="w"> </span><span class="n">l_sR</span><span class="p">,</span><span class="w"> </span><span class="n">l_inverse</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="c1">//calculate difference in the flux function</span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_fdelta</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="n">flux</span><span class="p">(</span><span class="n">i_hL</span><span class="p">,</span><span class="n">i_hR</span><span class="p">,</span><span class="n">i_huL</span><span class="p">,</span><span class="n">i_huR</span><span class="p">,</span><span class="n">l_fdelta</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="c1">//calculate Alpha</span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_eigencoefficients</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="n">eigencoefficientAlpha</span><span class="p">(</span><span class="n">l_inverse</span><span class="p">,</span><span class="n">l_fdelta</span><span class="p">,</span><span class="n">l_eigencoefficients</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="c1">//calculate Output</span>
<span class="w"> </span><span class="n">t_real</span><span class="w"> </span><span class="n">l_eigens</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">l_sL</span><span class="p">,</span><span class="n">l_sR</span><span class="p">};</span><span class="w"></span>
<span class="w"> </span><span class="n">decompose</span><span class="p">(</span><span class="n">l_eigencoefficients</span><span class="p">,</span><span class="n">l_eigens</span><span class="p">,</span><span class="n">o_minus_A_deltaQ</span><span class="p">,</span><span class="n">o_plus_A_deltaQ</span><span class="p">);</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We are given <span class="math notranslate nohighlight">\(q_l = [h_l, (hu)_l]^T\)</span> and <span class="math notranslate nohighlight">\(q_r = [h_r, (hu)_r]^T\)</span> so we simply plug them in the function to compute <span class="math notranslate nohighlight">\(A^- \Delta Q\)</span> and <span class="math notranslate nohighlight">\(A^+ \Delta Q\)</span> as 2D vector.
for more infromation check the <a class="reference external" href="https://tsunami-99843.web.app/">Documentation</a>.</p>
</div>
</section>
</section>
<section id="id1">
<h2><span class="section-number">2.3. </span>ParaView<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h2>
<p>Now that we have successfully implemented the Riemann Solver,
we can utilize it to create our own CSV files and employ them for wave visualization.
As demonstrated in the <a class="reference internal" href="setup.html#installation"><span class="std std-ref">Installation</span></a> section, we have learned how to generate these CSV files.
Simply import them into <a class="reference external" href="https://www.paraview.org/download">ParaView</a>, and from there,
you can proceed to export them as either images or animations.</p>
<p>Here is an example where we used 200 as the input.</p>
<video autoplay="True" controls="True" preload="auto" width="700"><source src="_static/animation.mp4" type="video/mp4"></video><div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure to hide the X and Y axes since they remain constant and won’t change, leaving us with only the “Height” and “Momentum X” values.</p>
</div>
<section id="conclusion">
<h3><span class="section-number">2.3.1. </span>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline"></a></h3>
<p>Congratulations! You’ve successfully learned how to use our numerical solver which uses the Riemann solver.in C++.
We hope this documentation helps you integrate the solver into your projects effectively.
If you have any questions or feedback, please don’t hesitate to contact us.</p>
</section>
</section>
<section id="personal-contribution">
<h2><span class="section-number">2.4. </span>Personal Contribution<a class="headerlink" href="#personal-contribution" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Ward Tammaa, Danial Schicker Doxygen Documentation</p></li>
<li><p>Mohamad Khaled Minawe, Ward Tammaa Sphnix Documentation</p></li>
<li><p>Danial Schicker Mohamad Khaled Minawe , Ward Tammaa functions implementation</p></li>
<li><p>Mohamad Khaled Minawe, Danial Schicker, Ward Tammaa Unit Testing</p></li>
<li><p>Mohamad Khaled Minawe, Danial Schicker Geogebra Datei(Calculation for the Unit Tests)</p></li>
<li><p>Ward Tammaa Hosting the code</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="setup.html" class="btn btn-neutral float-left" title="1. Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Finite%20Volume%20Discretization.html" class="btn btn-neutral float-right" title="3. Finite Volume Discretization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Minawe,Tammaa,Schicker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>